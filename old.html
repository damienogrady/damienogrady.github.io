<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
  <link rel="stylesheet" href="css/styles.css">
  <style>
    #mapCanvas {
      background-color: lightgray;
      background-image: url('small_world.jpg');
      width: 640px;
      height: 432px;
    }
    #odometer {
      font-size: 24px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div>
  <h1>Nathan Location and Ideation Dashboard</h1>
      <p><b>Note:</b>  We try to be as accurate and up-to-date as possible.  However, due to the dictates of the Heisenberg Uncertainty
        Principle, Nathan's location AND verbosity cannot <b>both</b> be
        determined at the same time.  There is therefore a fraction of
        a delay between the two outputs.
      </p>
  </div>
  <h2>Nathan Location</h2>
  <canvas id="mapCanvas"></canvas>
  <!-- <div id="odometer"></div> -->
  <div id="speedometer">
    <h2>Verbosity Velocity</h2>
      <div style="display: none;"><img id="sprite" src="assets/icons.svg"></div>
      <canvas id="canvas" width="425" height="210"></canvas>
  </div>

  <script src="js/fraction.min.js"></script>
  <script src="js/speedometer.js"></script>
  <script>
    // Get the canvas element and set its dimensions
    const mapcanvas = document.getElementById('mapCanvas');
    const ctx2 = mapcanvas.getContext('2d');
    mapcanvas.width = 640;
    mapcanvas.height = 432;

    // Set the initial dot position
    let dotX = mapcanvas.width / 2;
    let dotY = mapcanvas.height / 2;

    // Function to update the dot position and odometer speed
    function updateDashboard() {
      // Update dot position randomly
      dotX = 5 + Math.random() * (mapcanvas.width - 10);
      dotY = 5 + Math.random() * (mapcanvas.height - 10);

      // Clear the mapcanvas
      ctx2.clearRect(0, 0, mapcanvas.width, mapcanvas.height);

      // Draw the map background image
      //ctx2.drawImage(canvas.backgroundImage, 0, 0, canvas.width, canvas.height);

      // Draw the map
      ctx2.fillStyle = 'red';
      ctx2.beginPath();
      ctx2.arc(dotX, dotY, 5, 0, 2 * Math.PI);
      ctx2.fill();

      // Update odometer with random speed
      const speed = Math.random();
      // document.getElementById('odometer').innerText = 'Speed: ' + speed.toFixed(2) + ' km/h';

      // Schedule the next update
      setTimeout(updateDashboard, 2000);

      tacho = Math.random();
      gas = Math.random();
      mileage = Math.round(Math.random() * 100000)

      let turnSignalsStates = {
          'left':  true,
          'right': true
      }

      let iconsStates = {
          // main circle
          'dippedBeam': 1,
          'brake':      1,
          'drift':      1,
          'highBeam':   1,
          'lock':       1,
          'seatBelt':   1,
          'engineTemp': 2,
          'stab':       1,
          'abs':        1,
          // right circle
          'gas':        2,
          'trunk':      1,
          'bonnet':     1,
          'doors':      1,
          // left circle
          'battery':    2,
          'oil':        2,
          'engineFail': 2
      }
      draw(speed, tacho, gas, mileage, turnSignalsStates, iconsStates);
    }

    // Start the dashboard update
    updateDashboard();
  </script>
</body>
</html>
